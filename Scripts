#!/bin/bash

# Para ASCII Art and Header
echo -e "\n\033[1;36m"
cat << "EOF"

  _____  _______   __
 |  __ \|  __ \ \ / /
 | |__) | |  | \ V / 
 |  _  /| |  | |> <  
 | | \ \| |__| / . \ 
 |_|  \_\_____/_/ \_\
                     
                     

🤍 Framework Installer - github.com/Rdx

EOF
echo -e "\033[0m"

echo -e "\033[1;34mStarting Installation of Blueprint.zip\033[0m"
echo "-------------------------------------"

# Installation Steps
commands=(
  "sudo apt-get install -y ca-certificates curl gnupg"
  "sudo mkdir -p /etc/apt/keyrings"
  "curl -fsSL https://deb.nodesource.com/gpgkey/nodesource-repo.gpg.key | sudo gpg --dearmor -o /etc/apt/keyrings/nodesource.gpg"
  "echo 'deb [signed-by=/etc/apt/keyrings/nodesource.gpg] https://deb.nodesource.com/node_20.x nodistro main' | sudo tee /etc/apt/sources.list.d/nodesource.list"
  "sudo apt-get update"
  "sudo apt-get install -y nodejs"
  "sudo npm i -g yarn"
  "[ -d /var/www/pterodactyl ] && cd /var/www/pterodactyl || echo '⚠️ Skipping cd, directory not found'"
  "yarn"
  "sudo apt install -y zip unzip git curl wget"
  "wget $(curl -s https://api.github.com/repos/BlueprintFramework/framework/releases/latest | grep 'browser_download_url' | cut -d '\"' -f 4) -O release.zip"
  "unzip -o release.zip"
  "chmod +x blueprint.sh"
  "bash blueprint.sh"
)

# Execute commands with progress
total=${#commands[@]}
for i in "${!commands[@]}"; do
  step=$((i+1))
  echo -e "\033[1;33m[$step/$total] Executing:\033[0m \033[0;35m${commands[$i]}\033[0m"
  eval "${commands[$i]}"
  if [ $? -ne 0 ]; then
    echo -e "\033[1;31m❌ Error occurred at step $step. Aborting installation.\033[0m"
    exit 1
  fi
done

# Completion Message
echo -e "\n\033[1;32m-------------------------------------\033[0m"
echo -e "\033[1;32m✅ Blueprint extensions installed successfully! 🎉\033[0m"
echo -e "\033[1;35m           Made by Para\033[0m"
echo -e "\033[1;35m       github.com/Para\033[0m"
echo -e "\033[1;32m-------------------------------------\033[0m"
